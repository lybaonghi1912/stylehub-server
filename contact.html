<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Contact – STYLE HUB</title>
  <link rel="stylesheet" href="css/style.css" />
  </head>
<body>
<header>
  <div class="container header-flex">
    <h1 class="logo">STYLE HUB</h1>
    <nav>
      <ul class="menu">
        <li><a href="index.html">Home</a></li>
        <li><a href="products.html">Products</a></li>
        <li><a href="cart.html">Cart <span id="cart-count">0</span></a></li>
        <li><a href="#contact">Contact</a></li>
      </ul>
    </nav>
  </div>
</header>

<div class="main-content-wrap">
    <main class="container">
      <section class="contact-section" id="contact">
        <div class="contact-info">
          <h3>Contact Information</h3>
          <p><strong>Address:</strong> Nguyen Hue Street, Ho Chi Minh City, Vietnam</p>
          <p><strong>Phone:</strong> +84 123 456 789</p>
          <p><strong>Email:</strong> info@stylehub.com</p>
          <p>Our team is happy to assist you with your inquiries, feedback or support requests.</p>

          <iframe 
            src="https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d3919.338419739478!2d106.69929907518154!3d10.776897992323034!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x31752ee08b1f9d11%3A0x1b9b8bbd7c9dc54c!2sHo%20Chi%20Minh%20City%2C%20Vietnam!5e0!3m2!1sen!2s!4v1698901234567!5m2!1sen!2s" 
            allowfullscreen="" 
            loading="lazy">
          </iframe>
        </div>

        <div class="contact-form">
          <h3>Send Us Your Question</h3>
          <form id="contactForm">
            <label for="name">Full Name</label>
            <input type="text" id="name" placeholder="Your name" required />

            <label for="email">Email</label>
            <input type="email" id="email" placeholder="you@example.com" required />

            <label for="message">Message</label>
            <textarea id="message" rows="6" placeholder="Your message..." required></textarea>

            <button type="submit">Send Message</button>
          </form>
          <p id="formMsg" style="margin-top:15px; font-weight:bold; display:none;"></p>
        </div>
      </section>
    </main>
</div>
<footer>
  <div class="container footer-content">
    <p>© 2025 STYLE HUB. All rights reserved.</p>
    <p>Contact: info@stylehub.com</p>
  </div>
</footer>

<script>
function updateCartCount() {
    let cart = [];
    try { cart = JSON.parse(localStorage.getItem('cart') || '[]'); } 
    catch(e) { cart = []; }
    const cartEl = document.getElementById('cart-count');
    // Chỉ đếm số lượng item duy nhất (vì hàm này chỉ dùng cho thanh navbar)
    if(cartEl) cartEl.textContent = cart.length; 
}
updateCartCount();

// Gửi form tới API /api/contact để Server gửi Email
document.getElementById('contactForm').addEventListener('submit', async function(e){
    e.preventDefault();
    const msgEl = document.getElementById('formMsg');
    const name = document.getElementById('name').value.trim();
    const email = document.getElementById('email').value.trim();
    const message = document.getElementById('message').value.trim();

    // 1. Frontend Validation
    if (!name || !email || !message) {
        msgEl.style.color = '#FF4C4C'; // Đỏ
        msgEl.textContent = 'Vui lòng điền đầy đủ Tên, Email và Nội dung tin nhắn.';
        msgEl.style.display = 'block';
        return;
    }
    
    // Xóa thông báo cũ và hiện trạng thái tải
    msgEl.style.color = '#FFD700'; // Vàng
    msgEl.textContent = 'Đang gửi...';
    msgEl.style.display = 'block';


    // 2. Gửi API
    try {
        const response = await fetch('/api/contact', {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({ name, email, message })
        });
        const result = await response.json();

        if (result.success) {
            msgEl.style.color = '#008000'; // Xanh lá cây
            msgEl.textContent = result.message; // Message từ Server
            this.reset();
        } else {
            msgEl.style.color = '#FF4C4C'; // Đỏ
            msgEl.textContent = 'Lỗi gửi tin nhắn: ' + result.message;
        }

    } catch (error) {
        msgEl.style.color = '#FF4C4C';
        msgEl.textContent = 'Lỗi kết nối Server. Vui lòng thử lại sau.';
        console.error(error);
    }
});
</script>
</body>
</html>